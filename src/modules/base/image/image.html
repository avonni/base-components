<template>
    <div class="avonni-image">
        <div class={computedImageClass} data-element-id="container">
            <div class="slds-is-relative">
                <img
                    if:false={displayImageError}
                    style={computedStyle}
                    class="avonni-image_img_border-radius"
                    alt={alternativeText}
                    loading={lazyLoading}
                    sizes={sizes}
                    src={src}
                    srcset={srcset}
                    data-element-id="img"
                    onerror={handleImageError}
                    onload={handleLoadImage}
                    onmousemove={handleMagnifierMove}
                    onmouseout={handleMagnifierOut}
                    ontouchend={handleMagnifierOut}
                    ontouchmove={handleMagnifierMove}
                    ontouchstart={handleMagnifierMove}
                />
                <avonni-illustration
                    if:true={displayImageError}
                    style={computedStyle}
                    class="slds-p-around_medium"
                    size="large"
                    title={illustrationTitle}
                    variant={illustrationVariant}
                    data-element-id="avonni-illustration-image-error"
                >
                </avonni-illustration>
                <div
                    if:true={displayCompareLabel}
                    class={computedOverlayAfterClass}
                    data-element-id="compare-overlay-after"
                >
                    {compareAttributes.compareLabel}
                </div>
                <div
                    class="
                        avonni-image_magnifier-lens
                        slds-is-absolute
                        avonni-image_pointer-events-none
                    "
                    data-element-id="magnifier-lens"
                ></div>
                <div
                    class="
                        avonni-image_magnifier
                        slds-scrollable_none
                        slds-is-absolute
                        avonni-image_pointer-events-none
                    "
                    data-element-id="magnifier"
                >
                    <img
                        style={computedMagnifiedImgStyle}
                        class="
                            avonni-image_fit-content
                            avonni-image_pointer-events-none
                        "
                        alt=""
                        sizes={sizes}
                        src={src}
                        data-element-id="magnified-img"
                    />
                </div>
                <div
                    if:true={displayCompareSrc}
                    class={computedCompareContainerClass}
                    data-element-id="compare-container"
                    onmousedown={handleCompareMouseDown}
                    onmousemove={handleCompareMouseMove}
                    ontouchmove={handleCompareMouseMove}
                    ontouchstart={handleCompareMouseDown}
                >
                    <div
                        style={computedCompareImgContainerStyle}
                        class="
                            avonni-image__compare-img-container
                            slds-is-absolute
                            slds-scrollable_none
                        "
                        data-element-id="compare-img-container"
                    >
                        <img
                            style={computedCompareImgStyle}
                            class="avonni-image__compare-img"
                            alt={compareAlternativeText}
                            loading={lazyLoading}
                            src={compareSrc}
                            data-element-id="compare-img"
                        />
                        <div
                            if:true={compareAttributes.originalLabel}
                            class={computedOverlayBeforeClass}
                            data-element-id="compare-overlay-before"
                        >
                            {compareAttributes.originalLabel}
                        </div>
                    </div>
                    <div
                        style={computedSliderStyle}
                        class={computedSliderClass}
                        data-element-id="compare-slider"
                    >
                        <div
                            class={computedSliderHandleClass}
                            aria-pressed="false"
                            role="button"
                            tabindex="0"
                            data-element-id="compare-slider-handle"
                            onkeydown={handleCompareKeydown}
                        >
                            <lightning-icon
                                alternative-text={leftCompareIconAlternativeText}
                                icon-name={compareIconName1}
                                size="x-small"
                            >
                            </lightning-icon>
                            <lightning-icon
                                alternative-text={rightCompareIconAlternativeText}
                                icon-name={compareIconName2}
                                size="x-small"
                            >
                            </lightning-icon>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>
