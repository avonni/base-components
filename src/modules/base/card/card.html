<!--
/**
 * BSD 3-Clause License
 *
 * Copyright (c) 2021, Avonni Labs, Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * - Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 *
 * - Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 *
 * - Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
-->

<template>
    <article class={computedCardClasses}>
        <!-- only used for media center -->
        <div class="slds-m-around_x-small" if:true={showCenterMedia}>
            <p>{description}</p>
            <p>
                <template for:each={infos} for:item="info">
                    <a key={generateKey} href={info.href}>{info.label}</a>
                </template>
            </p>
        </div>

        <!-- media -->
        <div class="avonni-card__image-container" if:true={showMedia}>
            <slot name="media"></slot>
            <img class="avonni-card__image" src={imageSrc} if:true={imageSrc} />
            <slot name="image-action-container"></slot>

            <!-- action button -->
            <template
                for:each={actionPositions}
                for:item="actionList"
            ></template>
            <c-button-menu
                if:true={hasActions}
                class="media-actions"
                variant="border-filled"
                icon-name="standard:live_chat"
                icon-size="small"
                alternative-text="Actions"
                data-element-id="action-menu-icon"
                hide-down-arrow
            >
                <template for:each={actions} for:item="action">
                    <lightning-menu-item
                        key={action.name}
                        icon-name={action.iconName}
                        value={action.name}
                        label={action.label}
                        onclick={handleActionClick}
                    >
                    </lightning-menu-item>
                </template>
            </c-button-menu>

            <button
                if:true={hasAction}
                class="avonni-avatar-action-button slds-button slds-button_icon"
                data-element-id="action-icon"
                title={action.label}
                type="button"
                value={action.name}
                alternative-text={action.label}
                onclick={handleActionClick}
            >
                <c-primitive-icon
                    class="avonni-avatar-action-button-icon"
                    icon-name={action.iconName}
                >
                </c-primitive-icon>
            </button>
        </div>

        <!-- title and action -->
        <div class="slds-has-flexi-truncate card-content">
            <div class="slds-grid slds-m-around_x-small">
                <div class="slds-grid">
                    <c-avatar
                        if:true={avatar}
                        class="slds-m-right_x-small"
                        fallback-icon-name={avatar.fallbackIconName}
                        src={avatar.src}
                        initials="lk"
                        hide-avatar-details="true"
                        data-element-id="avonni-avatar"
                    ></c-avatar>

                    <div class="slds-media__body">
                        <span if:true={hasStringTitle}>{title}</span>
                        <span if:false={hasStringTitle}>
                            <slot name="title"></slot>
                        </span>
                        <template for:each={icons} for:item="icon"
                            ><lightning-icon
                                class="slds-m-left_x-small"
                                size="xx-small"
                                icon-name={icon}
                                key={generateKey}
                            ></lightning-icon>
                        </template>
                        <slot name="test"></slot>
                    </div>
                </div>

                <div class="slds-no-flex slds-col_bump-left">
                    <slot name="title-action"></slot>
                </div>
            </div>

            <!-- bottom content -->
            <div class="slds-m-around_x-small" if:false={showCenterMedia}>
                <slot name="description"></slot>
                <p>{description}</p>
                <p>
                    <template for:each={infos} for:item="info">
                        <a key={generateKey} href={info.href}>{info.label}</a>
                    </template>
                </p>
            </div>
        </div>
    </article>
</template>
