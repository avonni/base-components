<template>
    <div class="slds-template__container slds-grid slds-grid_vertical">
        <div
            class="avonni-tree__group-header"
            id="treeheading"
            data-element-id="h4-header"
        >
            {header}
        </div>
        <div
            class="
                avonni-tree__allow-shrink
                slds-grow slds-show
                slds-scrollable_y
            "
            aria-labelledby="treeheading"
            role="tree"
            data-element-id="div-tree-wrapper"
            onchange={handleChange}
            onfocus={handleFocus}
            onprivateactionclick={handleActionClick}
            onprivatemousedown={handleMouseDown}
            onprivateitemclick={handleClick}
            onprivateitemkeydown={handleKeydown}
            onprivateitemloadmore={handleLoadMore}
            onprivateregisteritem={handleRegistration}
        >
            <template for:each={children} for:item="item" for:index="index">
                <c-primitive-tree-item
                    key={item.key}
                    actions={item.actions}
                    actions-when-disabled={actionsWhenDisabled}
                    allow-inline-edit={allowInlineEdit}
                    aria-disabled={item.disabled}
                    aria-expanded={item.expanded}
                    aria-label={item.label}
                    aria-level={item.level}
                    avatar={item.avatar}
                    child-items={item.children}
                    cancel-button-label={cancelButtonLabel}
                    close-button-alternative-text={closeButtonAlternativeText}
                    collapse-button-alternative-text={collapseButtonAlternativeText}
                    collapse-disabled={collapseDisabled}
                    done-button-label={doneButtonLabel}
                    expand-button-alternative-text={expandButtonAlternativeText}
                    color={item.color}
                    independent-multi-select={independentMultiSelect}
                    disabled={item.disabled}
                    editable-fields={editableFields}
                    enable-infinite-loading={item.enableInfiniteLoading}
                    expanded={item.expanded}
                    fields={item.fields}
                    hidden-actions={item.hiddenActions}
                    href={item.href}
                    icon-name={item.iconName}
                    indeterminate={item.indeterminate}
                    is-loading={item.isLoading}
                    is-leaf={item.isLeaf}
                    label={item.label}
                    level={item.level}
                    loading-state-alternative-text={loadingStateAlternativeText}
                    metatext={item.metatext}
                    name={item.name}
                    node-key={item.key}
                    no-slots={item.noSlots}
                    role="treeitem"
                    save-button-icon-alternative-text={saveButtonIconAlternativeText}
                    selected={item.selected}
                    show-checkbox={isMultiSelect}
                    slottable-types={item.slottableTypes}
                    sortable={sortable}
                    type={item.type}
                    unselectable={item.unselectable}
                    data-key={item.key}
                    data-element-id="avonni-primitive-tree-item"
                ></c-primitive-tree-item>
            </template>
            <div
                if:true={isLoading}
                class="avonni-tree__loading-spinner slds-is-relative"
            >
                <lightning-spinner
                    alternative-text={loadingStateAlternativeText}
                    size="small"
                    data-element-id="lightning-spinner"
                ></lightning-spinner>
            </div>
        </div>
        <button
            if:true={addAction}
            class="
                slds-button slds-button_neutral slds-button_stretch
                slds-m-top_xx-small
                slds-m-left_none
            "
            type="button"
            data-element-id="button-add-action"
            onclick={handleActionClick}
        >
            <lightning-icon
                if:true={addAction.iconName}
                class="slds-m-right_x-small slds-current-color"
                icon-name={addAction.iconName}
                size="xx-small"
                variant="brand"
                data-element-id="lightning-icon-add-action"
            ></lightning-icon>
            {addButtonLabel}
        </button>
        <lightning-button
            if:true={showLoadMore}
            class="slds-m-top_xx-small slds-m-left_none"
            label={loadMoreButtonLabel}
            stretch
            data-element-id="lightning-button-load-more"
            onclick={handleLoadMore}
        ></lightning-button>
    </div>
</template>
