<template>
    <h1 if:true={isRoot}>{label}</h1>

    <div class={wrapperClass}>
        <!-- Visible column -->
        <div class={currentLevelClass}>
            <template for:each={groups} for:item="group">
                <div key={group.name} class="slds-card slds-p-around_medium">
                    <c-summary-detail
                        title={group.label}
                        full-width="true"
                        remove-body-indentation="true"
                        shrink-icon-name={shrinkIconName}
                        expand-icon-name={expandIconName}
                    >
                        <div slot="actions" if:true={group.actions}>
                            <template
                                for:each={group.actions}
                                for:item="action"
                            >
                                <lightning-button
                                    key={action.name}
                                    label={action.label}
                                ></lightning-button>
                            </template>
                        </div>

                        <!-- Item -->
                        <template if:true={group.items}>
                            <template for:each={group.items} for:item="item">
                                <div
                                    key={item.name}
                                    class="slds-box slds-p-around_none"
                                    onclick={handleSelect}
                                    data-name={item.name}
                                >
                                    <lightning-card
                                        title={item.label}
                                        icon-name={item.avatarFallbackIconName}
                                    >
                                        <div
                                            slot="actions"
                                            if:true={item.actions}
                                        >
                                            <template
                                                for:each={item.actions}
                                                for:item="action"
                                            >
                                                <lightning-button
                                                    key={action.name}
                                                    label={action.label}
                                                ></lightning-button>
                                            </template>
                                        </div>
                                        <div
                                            class="slds-region_narrow slds-card__body_inner"
                                        >
                                            <dl class="slds-dl_horizontal">
                                                <template if:true={item.data}>
                                                    <template
                                                        for:each={item.data}
                                                        for:item="data"
                                                    >
                                                        <dt
                                                            key={generateKey}
                                                            class="slds-dl_horizontal__label"
                                                        >
                                                            {data.label}
                                                        </dt>
                                                        <dd
                                                            key={generateKey}
                                                            class="slds-dl_horizontal__detail"
                                                        >
                                                            {data.value}
                                                        </dd>
                                                    </template>
                                                </template>
                                            </dl>
                                        </div>
                                    </lightning-card>
                                </div>
                            </template>
                        </template>
                    </c-summary-detail>
                </div>
            </template>
        </div>

        <!-- Column revealed on click -->
        <div class={selectedLevelClass} if:true={selectedGroups}>
            <c-relationship-graph
                onselect={dispatchSelectEvent}
                is-root="false"
                groups={selectedGroups}
                variant={variant}
                shrink-icon-name={shrinkIconName}
                expand-icon-name={expandIconName}
            ></c-relationship-graph>
        </div>
    </div>
</template>
